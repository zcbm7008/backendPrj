<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>제품 목록</title>
    <th:block th:replace="fragments/layout :: cssjs"/>
</head>
<body>

<div th:replace="fragments/layout :: header"></div>

<div class="search-container" style="margin-bottom: 20px;">
    <form action="@{/categories/{categoryId}(categoryId=${itemInCategory.category.id})}" method="get">
        <input type="hidden" name="page" value="1" /> <!-- 검색 시 항상 첫 페이지로 리셋 -->
        <div class="input-group mb-3">
            <input type="text" class="form-control" placeholder="검색어 입력" name="search" aria-label="검색어">
            <button class="btn btn-outline-secondary" type="submit" id="button-addon2">검색</button>
        </div>
    </form>
</div>

<div class="container">
    <h2 th:text="${itemInCategory.category.name}">카테고리</h2>

    <span th:if="${itemInCategory.items.isEmpty()}">상품이 없습니다.</span>

    <div class="card mb-3" style="max-width: 540px;" th:each="item: ${itemInCategory.items}">
        <div class="row g-0">
            <div class="col-md-4">
                <a th:href="@{/items/{itemId}(itemId=${item.id})}">
                    <img class="img-fluid rounded-start" th:src="${item.image}" src=""
                         th:alt="${item.name}">
                </a>
            </div>
            <div class="col-md-8">
                <div class="card-body">
                    <h5 class="card-title" th:text="${item.name}">이름</h5>
                    <p class="card-text">판매자 : [[${item.sellerName}]]</p>
                    <p class="card-text">가격 : [[${item.price}]]</p>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="pagination">
    <a th:href="@{/categories/{categoryId}(categoryId=${itemInCategory.category.id}, page=${itemInCategory.page - 1})}"
       th:if="${itemInCategory.page > 1}"  class="btn btn-primary">이전</a>
    <th:block th:each="pageNum: ${#numbers.sequence(startPage,endPage)}">
        <a th:href="@{/categories/{categoryId}(categoryId=${itemInCategory.category.id}, page=${pageNum})}"
           th:class="${pageNum} == ${itemInCategory.page} ? 'btn btn-primary' : 'btn btn-default'"
           th:text="${pageNum}">1</a>
    </th:block>
    <a th:href="@{/categories/{categoryId}(categoryId=${itemInCategory.category.id}, page=${itemInCategory.page + 1})}"
       th:if="${itemInCategory.page < itemInCategory.totalPages}" class="btn btn-primary">다음</a>
</div>

<div th:replace="fragments/layout :: footer"></div>

</body>
</html>
